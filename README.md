# CRC_To_HEX_Py

Скрипт предназначен для вставки контрольной суммы CRC16 в конец hex файла прошивки для последующего самотестирования кода во FLASH памяти микроконтроллера.
Скрипт создан для среды разработки STM32CubeIDE.

Проект, который являлся исходным материалом для данного скрипта: https://github.com/ethanhuanginst/STM32CubeIDE-Workshop-2019/tree/master/hands-on/06_F746-DISCO-CRC

## Подготовка (для Windows)

1. Скачать и установить интерпретатор Python3 (при установке доабвить исполняемый файл python в переменную среды Path);
2. Разместить файл crc_to_hex.py и srec_cat.exe в корневом каталоге проекта STM32CubeIDE;

## Настройка выполнения скрипта

1. Открыть проект STM32CubeIDE;
2. Нажать правой кнопкой мыши на проект и выбрать Propierties;
3. Открыть раздел C/C++ Build->Settings вкладка Build Steps;
4. В поле "Command:" раздела "Post-build steps" вписать строку:

```
python ../crc_to_hex.py "${ProjName}.hex" "${ProjName}_CRC.hex"
```
![Скриншот настройки выполнения](Resources/settings.png)


Далее после компиляции проекта будет создаваться Hex файл прошивки с контрольной суммой в конце.

## Настройка загрузки Hex файла с контрольной суммой при отладке

1. Создать отладочную конфигурацию и зайти в раздел Startup;
2. В поле Load Image and Symbols необходимо добавить новую строку с настройкой на Hex файл с контрольной суммой;
3. Далее настройки произвести как на примере ниже:

![Скриншот настройки загрузки](Resources/debug_settings.png)

